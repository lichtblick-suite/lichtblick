# Lichtblick Suite-Base ディレクトリ調査計画書

## 📋 調査概要

本計画書は、`packages/suite-base/src`ディレクトリ直下の各ディレクトリを体系的に調査し、Lichtblickアプリケーションのアーキテクチャと機能を理解するための指針を提供します。

## 🎯 調査目的

1. **アーキテクチャ理解**: アプリケーション全体の構造と設計思想の把握
2. **機能把握**: 各ディレクトリの役割と相互関係の理解
3. **開発効率向上**: 効率的な開発・保守のための知識習得
4. **ドキュメント整備**: 各ディレクトリの詳細ドキュメント作成

## 📊 調査対象ディレクトリ一覧

### 🔥 最優先（Phase 1）- アーキテクチャ基盤

- `context/` - React Context API定義
- `types/` - TypeScript型定義
- `providers/` - 状態管理実装

### ⚡ 高優先（Phase 2）- コア機能

- `components/` - UIコンポーネント
- `players/` - データ処理エンジン
- `dataSources/` - データソース管理

### 🚀 中優先（Phase 3）- 機能拡張

- `panels/` - 個別パネル実装
- `hooks/` - カスタムフック
- `services/` - サービス層

### 📦 低優先（Phase 4）- サポート系

- `util/` - ユーティリティ関数
- `constants/` - 定数定義
- `theme/` - テーマ・スタイル
- `i18n/` - 国際化

### 🧪 最終段階（Phase 5）- 開発支援

- `test/`, `testing/`, `stories/` - テスト関連
- `assets/`, `styles/`, `typings/` - アセット・スタイル

## 📋 調査計画詳細

### Phase 1: アーキテクチャ基盤調査 🔥

#### 1.1 `context/` ディレクトリ

**調査目的**: アプリケーション全体の状態管理アーキテクチャを理解

**調査項目**:

- [ ] React Context定義の一覧化
- [ ] 各Contextの役割と責任範囲の把握
- [ ] Context間の依存関係の分析
- [ ] 状態管理パターンの理解

**成果物**: ✅ **完了済み**

- ~~`context/README.md` - Context一覧と使用方法~~
- ✅ **各重要Contextファイルへの詳細コメント追加** - 25+ファイルに包括的なJSDocコメント追加完了
- ✅ **CurrentLayoutContextディレクトリ** - 完全なコメント追加とドキュメント化完了

**推定工数**: 2-3時間 → **実際: 4-5時間** (想定以上の詳細ドキュメント化を実施)

#### 1.2 `types/` ディレクトリ

**調査目的**: アプリケーション全体で使用される型定義の把握

**調査項目**:

- [x] 基本型定義の整理
- [x] 複合型・インターフェースの分析
- [x] 型の使用箇所と依存関係の調査
- [x] 型安全性の確保方法の理解

**成果物**: ✅ **完了済み**

- ✅ **全11ファイルに包括的なJSDocコメント追加完了**
  - `Messages.ts` - ROS/RVizメッセージ型定義（656行）に詳細コメント
  - `RosDatatypes.ts` - ROSデータ型定義の拡張に関する説明
  - `hoverValue.ts` - ホバー値型定義の詳細説明
  - `isTypedArray.ts` - TypedArray型判定の詳細説明
  - `layouts.ts` - レイアウト型定義の詳細説明
  - `panels.ts` - パネル型定義の詳細説明
  - `Bounds.ts` - 境界値型定義の詳細説明
  - `Extensions.ts` - 拡張機能型定義の詳細説明
  - `FoxgloveMessages.ts` - Foxglove固有メッセージ型の詳細説明
  - `Icons.ts` - アイコン型定義の詳細説明
  - `LaunchPreferenceValue.ts` - 起動設定型の詳細説明

**推定工数**: 1-2時間 → **実際**: 3-4時間（想定以上の詳細ドキュメント化を実施）

#### 1.3 `providers/` ディレクトリ

**調査目的**: 状態管理の具体的な実装パターンを理解

**調査項目**:

- [x] 各Providerの実装パターン分析
- [x] 初期化処理の流れの把握
- [x] Provider間の連携方法の理解
- [x] パフォーマンス最適化手法の調査

**成果物**: ✅ **進行中** - メインディレクトリ完了、サブディレクトリ調査中

- ✅ **メインProviderファイルへの詳細コメント追加完了** - 10+ファイルに包括的なJSDocコメント追加
  - `AlertsContextProvider.tsx` - アラート管理システム（48行）
  - `AppParametersProvider.tsx` - アプリケーションパラメータ管理（38行）
  - `EventsProvider.tsx` - タイムラインイベント管理（56行）
  - `ExtensionMarketplaceProvider.tsx` - 拡張機能マーケットプレイス管理（39行）
  - `ExtensionCatalogProvider.tsx` - 拡張機能ライフサイクル管理（312行）
  - `LayoutManagerProvider.tsx` - レイアウト管理システム（76行）
  - `PanelCatalogProvider.tsx` - パネルカタログ管理（99行）
  - `PanelStateContextProvider.tsx` - パネル状態管理（122行）
  - `TimelineInteractionStateProvider.tsx` - タイムライン相互作用状態管理（88行）
  - `UserProfileLocalStorageProvider.tsx` - ユーザープロファイル永続化（65行）
  - `WorkspaceContextProvider.tsx` - ワークスペース状態管理（105行）

**サブディレクトリ調査予定**:

- [ ] `helpers/` - Provider補助機能の詳細調査
- [ ] `StudioLogsSettingsProvider/` - ログ設定Provider専用ディレクトリ
- [ ] `CurrentLayoutProvider/` - レイアウトProvider専用ディレクトリ
- [ ] `CurrentLayoutProvider/hooks/` - レイアウト関連カスタムフック

**推定工数**: 2-3時間 → **実際**: 4-5時間（想定以上の詳細ドキュメント化を実施）

### Phase 2: コア機能調査 ⚡

#### 2.1 `components/` ディレクトリ

**調査目的**: UIコンポーネントの構造と設計パターンを理解

**調査項目**:

- [ ] コンポーネント階層の分析
- [ ] 再利用可能コンポーネントの特定
- [ ] スタイリング手法の調査
- [ ] コンポーネント間の通信パターン

**成果物**:

- `components/README.md` - コンポーネント設計ガイド
- 主要コンポーネントの詳細ドキュメント

**推定工数**: 4-5時間

#### 2.2 `players/` ディレクトリ

**調査目的**: データ処理エンジンの仕組みを理解

**調査項目**:

- [ ] 各Playerの役割と特徴の分析
- [ ] データフローの追跡
- [ ] ROSとの連携方法の詳細調査
- [ ] パフォーマンス特性の理解

**成果物**:

- `players/README.md` - Player実装ガイド
- 各Playerの詳細ドキュメント

**推定工数**: 3-4時間

#### 2.3 `dataSources/` ディレクトリ

**調査目的**: データソース管理の仕組みを理解

**調査項目**:

- [ ] データソースファクトリーパターンの分析
- [ ] 各データソースの特徴と使用場面
- [ ] データソース切り替えの仕組み
- [ ] エラーハンドリングの実装

**成果物**:

- `dataSources/README.md` - データソース管理ガイド
- データソース実装パターンの解説

**推定工数**: 2-3時間

### Phase 3: 機能拡張調査 🚀

#### 3.1 `panels/` ディレクトリ

**調査目的**: 個別パネルの実装パターンを理解

**調査項目**:

- [ ] パネル種類の分類と特徴分析
- [ ] パネル共通インターフェースの理解
- [ ] データ可視化手法の調査
- [ ] パネル間の連携方法

**成果物**:

- `panels/README.md` - パネル開発ガイド
- 代表的なパネルの実装解説

**推定工数**: 5-6時間

#### 3.2 `hooks/` ディレクトリ

**調査目的**: カスタムフックの設計パターンを理解

**調査項目**:

- [ ] カスタムフックの分類と用途
- [ ] 状態管理フックの実装パターン
- [ ] 副作用処理の抽象化手法
- [ ] フック間の依存関係

**成果物**:

- `hooks/README.md` - カスタムフック開発ガイド
- 重要フックの使用例

**推定工数**: 2-3時間

#### 3.3 `services/` ディレクトリ

**調査目的**: サービス層の設計を理解

**調査項目**:

- [ ] サービス層の責任範囲の分析
- [ ] ビジネスロジックの実装パターン
- [ ] 外部APIとの連携方法
- [ ] エラーハンドリングとリトライ機構

**成果物**:

- `services/README.md` - サービス層設計ガイド
- 主要サービスの実装解説

**推定工数**: 2-3時間

### Phase 4: サポート系調査 📦

#### 4.1 `util/` ディレクトリ

**調査項目**:

- [ ] ユーティリティ関数の分類
- [ ] 共通処理の抽象化パターン
- [ ] パフォーマンス最適化手法

**推定工数**: 1-2時間

#### 4.2 `constants/` ディレクトリ

**調査項目**:

- [ ] 定数の分類と管理方法
- [ ] 設定値の階層化
- [ ] 環境別定数の管理

**推定工数**: 1時間

#### 4.3 `theme/` ディレクトリ

**調査項目**:

- [ ] テーマシステムの実装
- [ ] ダークモード対応
- [ ] カスタマイズ可能な要素

**推定工数**: 1-2時間

#### 4.4 `i18n/` ディレクトリ

**調査項目**:

- [ ] 国際化の実装方法
- [ ] 翻訳リソースの管理
- [ ] 動的言語切り替え

**推定工数**: 1-2時間

### Phase 5: 開発支援調査 🧪

#### 5.1 テスト関連ディレクトリ

**調査項目**:

- [ ] テスト戦略とパターン
- [ ] モック・スタブの実装
- [ ] E2Eテストの構成

**推定工数**: 2-3時間

#### 5.2 アセット・スタイル関連

**調査項目**:

- [ ] アセット管理方法
- [ ] スタイルガイドライン
- [ ] 型定義の拡張方法

**推定工数**: 1-2時間

## 📈 進捗管理

### 調査状況トラッキング

- [ ] **Phase 1完了** (推定: 5-8時間 → 実際: 11-14時間)

  - [x] context/調査完了 ✅ **完了済み** - 全Contextファイルに詳細コメント追加済み
  - [x] types/調査完了 ✅ **完了済み** - 全11ファイルに包括的なJSDocコメント追加済み
  - [ ] providers/調査完了 🔄 **進行中** - メインディレクトリ完了、サブディレクトリ調査中

- [ ] **Phase 2完了** (推定: 9-12時間)

  - [ ] components/調査完了
  - [ ] players/調査完了
  - [ ] dataSources/調査完了

- [ ] **Phase 3完了** (推定: 9-12時間)

  - [ ] panels/調査完了
  - [ ] hooks/調査完了
  - [ ] services/調査完了

- [ ] **Phase 4完了** (推定: 4-7時間)

  - [ ] util/調査完了
  - [ ] constants/調査完了
  - [ ] theme/調査完了
  - [ ] i18n/調査完了

- [ ] **Phase 5完了** (推定: 3-5時間)
  - [ ] test関連調査完了
  - [ ] assets/styles関連調査完了

### 総推定工数

**合計: 30-44時間**

## 🎯 調査のポイント

### 効率的な調査のためのガイドライン

1. **段階的アプローチ**: 各Phaseを順序通りに進める
2. **相互関係の把握**: ディレクトリ間の依存関係を常に意識
3. **実装パターンの抽出**: 共通的な設計パターンを見つける
4. **ドキュメント作成**: 調査結果を必ず文書化する
5. **コード理解**: 重要なファイルには詳細コメントを追加

### 調査時の注意点

- **深掘りしすぎない**: 最初は全体像の把握を優先
- **依存関係を追跡**: import/exportの関係を理解
- **テストコードも参照**: 使用例として活用
- **Git履歴を確認**: 変更理由や設計思想を理解

## 📚 参考資料

- [ARCHITECTURE_GUIDE.md](./ARCHITECTURE_GUIDE.md) - アーキテクチャ全体の解説
- [PLATFORM_PACKAGES_GUIDE.md](./PLATFORM_PACKAGES_GUIDE.md) - プラットフォーム固有パッケージの解説
- [README.md](./README.md) - プロジェクト概要

## 🔄 更新履歴

- **2025-07-02**: 初版作成
- **2025-07-03**: Phase 1 - context/ディレクトリ調査完了 ✅
  - 25+のContextファイルに詳細JSDocコメント追加
  - CurrentLayoutContextディレクトリの完全ドキュメント化
  - アーキテクチャパターンの詳細解説追加
- **2025-07-04**: Phase 1 - types/ディレクトリ調査完了 ✅
  - 全11ファイルに包括的なJSDocコメント追加
  - ROS/RVizメッセージ型定義（656行）の詳細ドキュメント化
  - TypedArray、境界値、拡張機能などの型定義に詳細説明追加
  - アイコン型と起動設定型の完全ドキュメント化
- **2025-07-05**: Phase 1 - providers/ディレクトリ調査進行中 🔄
  - 11個のメインProviderファイルに詳細JSDocコメント追加完了
  - Zustandベースの状態管理パターンの詳細解析完了
  - 永続化、マイグレーション、パフォーマンス最適化手法の解説追加
  - 拡張機能管理（ExtensionCatalogProvider 312行）の完全ドキュメント化
  - 次段階：サブディレクトリ（helpers/, StudioLogsSettingsProvider/, CurrentLayoutProvider/）の詳細調査予定

---

**注意**: この調査計画書は、Lichtblickプロジェクトの理解を深めるための指針です。実際の調査では、発見した内容に応じて計画を柔軟に調整してください。

**次のステップ**: Phase 1の`context/`ディレクトリから調査を開始することを推奨します。
